(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{296:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var s=t(5155),o=t(2115),a=t(5695),l=t(6766),n=t(5215);function i(){let[e,r]=(0,o.useState)(""),[t,i]=(0,o.useState)("");(0,a.useRouter)();let{login:c,loginLoading:u,loginError:d}=(0,n.A)();return u?(0,s.jsx)("div",{children:"Loading..."}):(0,s.jsx)("div",{className:"flex min-h-screen bg-cover bg-no-repeat bg-center relative",style:{backgroundImage:"url('/images/login_bg.png')"},children:(0,s.jsx)("div",{className:"flex justify-center items-center my-auto h-full w-full relative z-10",children:(0,s.jsxs)("div",{className:"bg-slate-100/80 p-8 rounded-lg shadow-lg max-w-2xl w-full flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex justify-center items-center",children:(0,s.jsx)(l.default,{src:"/images/BLWSDAI_logo.png",alt:"BLWSDAI Logo",width:500,height:500})}),(0,s.jsxs)("div",{className:"flex flex-col w-full ml-6",children:[(0,s.jsx)("h2",{className:"text-left text-2xl font-semibold mb-4 text-gray-700",children:"Login to your account"}),(0,s.jsxs)("form",{onSubmit:r=>{r.preventDefault(),c({email:e,password:t})},className:"w-full",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,s.jsx)("input",{type:"email",id:"email",value:e,onChange:e=>r(e.target.value),placeholder:"example@email.com",className:"bg-slate-100/80 placeholder:text-slate-300 w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,s.jsx)("a",{href:"#",className:"text-blue-600 text-sm hover:text-blue-800",children:"Forgot?"})]}),(0,s.jsx)("input",{type:"password",id:"password",value:t,onChange:e=>i(e.target.value),placeholder:"Enter your password",className:"bg-slate-100/80 placeholder:text-slate-300 w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)("button",{type:"submit",className:"w-full py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50",disabled:u,children:u?"Logging in...":"Log In"})})]})]})]})})})}},3248:(e,r,t)=>{"use strict";t.d(r,{i:()=>o});var s=t(4725);let o={login:async(e,r)=>{try{let t=await s.A.post("/users/login",{email:e,password:r});if(t.data&&t.data.token)return t.data;throw Error("Login failed, no token received.")}catch(e){throw console.error("Login error:",e),e}},logout:async()=>{try{return(await s.A.post("/users/logout")).data}catch(e){throw console.error("Logout error:",e),e}},getAll:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;try{return(await s.A.get("/users",{params:{page:e,pageSize:r}})).data}catch(e){throw console.error("Error fetching all users:",e),e}},getById:async e=>{try{return(await s.A.get("/users/".concat(e))).data}catch(r){throw console.error("Error fetching user with id ".concat(e,":"),r),r}},createUser:async e=>{try{return(await s.A.post("/users",e)).data}catch(e){throw console.error("Error creating user:",e),e}},updateUser:async(e,r)=>{try{return(await s.A.put("/users/".concat(e),r)).data}catch(r){throw console.error("Error updating user with id ".concat(e,":"),r),r}},deleteUser:async e=>{try{return(await s.A.delete("/users/".concat(e))).data}catch(r){throw console.error("Error deleting user with id ".concat(e,":"),r),r}},filterUsers:async e=>{try{return(await s.A.post("/users/filter",e)).data}catch(e){throw console.error("Error filtering users:",e),e}}}},4474:(e,r,t)=>{Promise.resolve().then(t.bind(t,296))},4725:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var s=t(3464),o=t(7948);let a=s.A.create({baseURL:"https://localhost:7295/api"});a.interceptors.request.use(e=>{let r=o.A.getState().token;return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status?console.error("Unauthorized access - token may be expired."):e.response&&403===e.response.status&&console.error("Forbidden access."),Promise.reject(e)));let l=a},5215:(e,r,t)=>{"use strict";t.d(r,{A:()=>c});var s=t(5041),o=t(7948),a=t(3248),l=t(5695),n=t(6715),i=t(2115);let c=()=>{let{token:e,userId:r,userRole:t,setUser:c,clearUser:u}=(0,o.A)(),d=(0,l.useRouter)(),g=(0,n.jE)();(0,i.useEffect)(()=>{e&&r&&t||d.push("/")},[e,r,t,d]);let h=(0,s.n)({mutationFn:async e=>{let{email:r,password:t}=e,s=await a.i.login(r,t);c(s.token,s.user.userId,s.user.role);let o=await a.i.getById(s.user.userId);return o?(g.setQueryData(["user",s.user.userId],o),d.push("/dashboard")):console.error("User not found"),s},onError:e=>{alert("Login failed:",e),console.error("Login failed:",e)}}),m=(0,s.n)({mutationFn:async()=>{await a.i.logout(),u(),g.invalidateQueries(["user"])},onSuccess:()=>{console.log("Logged out successfully")},onError:e=>{console.error("Logout failed:",e)}});return{login:h.mutate,logout:m.mutate,loginLoading:h.isLoading,logoutLoading:m.isLoading,loginError:h.isError,logoutError:m.isError}}},7948:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});var s=t(5453),o=t(6786);let a=(0,s.v)((0,o.Zr)(e=>({token:null,userId:null,userRole:null,setUser:(r,t,s)=>e({token:r,userId:t,userRole:s}),clearUser:()=>e({token:null,userId:null,userRole:null})}),{name:"auth-storage",getStorage:()=>localStorage}))}},e=>{var r=r=>e(e.s=r);e.O(0,[246,280,441,684,358],()=>r(4474)),_N_E=e.O()}]);